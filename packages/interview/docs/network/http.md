# HTTP 协议

HTTP协议，全称超文本传输协议（Hypertext Transfer Protocol），是互联网上应用最为广泛的一种网络协议。所有的WWW文件都必须遵守这个标准。HTTP协议定义了客户端和服务器之间的通信格式，主要基于"请求与响应"模式。

HTTP的主要特点可以包括：

1. **无连接**：每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。为了提升效率，现在的浏览器一般使用长连接，即在一个连接上可以发送多个请求。

2. **无状态**：HTTP协议是无状态协议。无状态是指协议对于事务处理没有记忆能力，服务器不知道客户端是什么状态。这也是为什么在需要保持登录状态的网页需要用到cookie或session技术的原因。

3. **支持B/S及C/S模式**。

HTTP协议定义了许多（如GET、POST、PUT、DELETE等）请求方法，这些方法描述了对于资源的不同操作方式。每种方法对应的语义各不相同：

- GET：请求获取指定资源。
- POST：向指定资源提交数据，数据被包含在请求体中。这可能导致新的资源的创建和/或已有资源的修改。
- PUT：向指定资源位置上传其最新内容。
- DELETE：请求服务器删除 Request-URI 所标识的资源。
- HEAD：请求获取由 Request-URI 所标识的资源的响应消息报头。
- CONNECT：HTTP/1.1 协议中预留给能够将连接改为管道方式的代理服务器。
- OPTIONS：允许客户端查看服务器的性能。
- TRACE：回显服务器收到的请求，主要用于测试或诊断。

在HTTP/1.1版本中引入了持久连接，以减少TCP连接的建立和关闭的开销。在HTTP/2中，更进一步引入了多路复用、头部压缩等技术，提高了HTTP协议的性能。

HTTP协议通信过程中的安全性可以通过使用HTTPS来提升，HTTPS就是在HTTP和TCP之间加入了一个SSL/TLS层，对数据进行加密，提高了数据的保密性和完整性。

## HTTP/1.1 版本中持久连接

在HTTP/1.0中，每个HTTP请求/应答都需要建立一个新的TCP连接。TCP连接的建立包括了"三次握手"，而关闭则需要"四次挥手"，这其中的过程相对耗时。因此，当一个页面包含很多资源需要加载时（如图片、CSS、JavaScript文件等），这种频繁的建立和关闭连接会导致显著的延迟和性能开销。

为了改善这个问题，HTTP/1.1引入了持久连接（persistent connection），也被称为HTTP keep-alive，或者连接重用（connection reuse）。持久连接的特点是，在一个HTTP会话中，客户端与服务器只需要建立一次TCP连接，之后所有的请求和响应都复用这一次的连接。当请求处理完后，连接不会立即关闭，而是保持打开状态，以便用于后续的请求。

HTTP/1.1中，默认情况下所有的连接都被视为持久连接，除非明确指定"Connection: close"来要求关闭连接。在一个持久连接上可以发送多个请求，不过这些请求必须串行发送，即每次只能发送一个请求，等待服务器响应后，再发送下一个请求。这种方式虽然减少了TCP连接的建立和关闭的开销，但仍存在一定的效率问题。

为了进一步提高性能，HTTP/2进一步引入了多路复用（Multiplexing）的概念，允许在一个持久连接上同时并行发送多个请求或者接收多个响应。这样可以避免"队头阻塞"的问题，即便是某一个请求处理比较慢，也不会影响到其他的请求/响应，从而使得连接的利用率更高，性能更好。

## HTTP/2 

HTTP/2，也被称为Hypertext Transfer Protocol Version 2，是HTTP协议的第二个主要版本，用于Web数据通信。相比于HTTP/1.1，HTTP/2引入了许多重要的改进，这些改进主要是为了解决Web性能问题，提升数据传输效率。

以下是HTTP/2的一些主要特性：

1. **二进制协议**：HTTP/2是一个二进制协议，而非HTTP/1.x的文本协议。二进制协议解析更高效、更精确，能够消除不必要的错误和歧义。

2. **多路复用**：在一个TCP连接中，HTTP/2可以同时处理多个请求和响应，而不是按顺序一个接一个的处理。这意味着服务器能够在一个响应被处理的同时，处理其他的请求，从而极大地减少了延迟并提升了整体的性能。

3. **首部压缩**：HTTP/2引入了HPACK压缩，用于减小请求和响应首部的大小，从而进一步提高性能。

4. **服务器推送**：在HTTP/2中，服务器可以主动将未请求的资源推送给客户端，以便预先缓存，从而提高页面的加载速度。

5. **流优先级**：HTTP/2允许设置请求优先级，这使得重要的请求可以优先得到响应，提升用户体验。

6. **请求依赖性**：在HTTP/2中，可以设置请求之间的依赖关系，例如，某个请求的处理可能需要等待另一个请求的结果。

这些新特性使得HTTP/2在性能、效率和安全性方面都有了显著的提升，被广泛应用于现代Web开发中。